# Autonotes Backend

[![Java CI with Gradle](https://github.com/IWKMS99/AutonotesBackend/actions/workflows/gradle.yml/badge.svg)](https://github.com/IWKMS99/AutonotesBackend/actions/workflows/gradle.yml)

–ë—ç–∫–µ–Ω–¥-—Å–µ—Ä–≤–∏—Å –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ "Autonotes" ‚Äî –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Å–ø–µ–∫—Ç–æ–≤ –ª–µ–∫—Ü–∏–π —Å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –¥–æ—Å–∫–∏.

## üöÄ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

*   **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
    *   –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –≤—Ö–æ–¥ (JWT Access Token).
    *   Stateless –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (Spring Security).
    *   Rate Limiting (Bucket4j) –Ω–∞ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞—Ö –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.

*   **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Å–ø–µ–∫—Ç–∞–º–∏ (CRUD):**
    *   –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (Multipart file) -> –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ **MinIO** (S3).
    *   –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–±—ã—Ç–∏–π –æ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–æ–Ω—Å–ø–µ–∫—Ç–∞ –≤ **RabbitMQ** (`notes.exchange` -> `notes.process.queue`) –¥–ª—è ML-–æ–±—Ä–∞–±–æ—Ç–∫–∏.
    *   –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ (`PROCESSING`, `COMPLETED`, `FAILED`).
    *   –ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ: –∑–∞–ø–∏—Å—å –≤ –ë–î + —Ñ–∞–π–ª –≤ S3.

*   **–§–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏:**
    *   **Cleanup Service**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–º–µ—Ç–∫–∞ –∑–∞–≤–∏—Å—à–∏—Ö –∑–∞–¥–∞—á –∫–∞–∫ `FAILED`, –µ—Å–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–Ω–∏–º–∞–µ—Ç –±–æ–ª–µ–µ 10 –º–∏–Ω—É—Ç (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `app.notes.processing-timeout-minutes`).

*   **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:**
    *   –ì–ª–æ–±–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (`GlobalExceptionHandler`).
    *   –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å **Testcontainers** (PostgreSQL, MinIO, RabbitMQ).
    *   –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ —á–µ—Ä–µ–∑ AOP –∏ MDC (`RequestIdFilter`).

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

*   **Language:** Java 24
*   **Framework:** Spring Boot 3.5.7
*   **DB:** PostgreSQL 16 + Flyway Migration
*   **Storage:** MinIO (S3 compatible)
*   **Messaging:** RabbitMQ
*   **Docs:** Springdoc OpenAPI (Swagger)
*   **Build:** Gradle

## ‚öôÔ∏è –ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ

1.  **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:** JDK 21+, Docker (–¥–ª—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã).
2.  **–ó–∞–ø—É—Å–∫ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã:**
    –í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ (–≥–¥–µ `docker-compose.yml`) –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
    ```bash
    docker-compose up -d db minio rabbitmq
    ```
3.  **–ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:**
    ```bash
    ./gradlew bootRun
    ```

## üîë –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è)

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (Environment Variables). –ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –≤ `application.properties`.

### –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|:---|:---|:---|
| `SERVER_PORT` | –ü–æ—Ä—Ç, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞. | `8080` |
| `JWT_SECRET` | **(–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)** –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á (Base64) –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ JWT —Ç–æ–∫–µ–Ω–æ–≤. | *–ù–µ—Ç* |
| `JWT_EXPIRATION_MS` | –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ Access-—Ç–æ–∫–µ–Ω–∞ –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö. | `86400000` (24—á) |

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (PostgreSQL)
| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|:---|:---|:---|
| `SPRING_DATASOURCE_URL` | JDBC URL –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î. | `jdbc:postgresql://localhost:5432/autonotes` |
| `SPRING_DATASOURCE_USERNAME` | –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ë–î. | `myuser` |
| `SPRING_DATASOURCE_PASSWORD` | –ü–∞—Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ë–î. | `mypassword` |
| `SPRING_JPA_HIBERNATE_DDL_AUTO` | –†–µ–∂–∏–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ö–µ–º–æ–π Hibernate (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è `validate` –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞). | `validate` |

### –§–∞–π–ª–æ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (MinIO / S3)
| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|:---|:---|:---|
| `MINIO_ENDPOINT` | URL API S3-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞. | *–ù–µ—Ç* |
| `MINIO_ACCESS_KEY` | Access Key (–ª–æ–≥–∏–Ω) –¥–ª—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞. | *–ù–µ—Ç* |
| `MINIO_SECRET_KEY` | Secret Key (–ø–∞—Ä–æ–ª—å) –¥–ª—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞. | *–ù–µ—Ç* |
| `aws.s3.bucket` | –ò–º—è –±–∞–∫–µ—Ç–∞, –∫—É–¥–∞ –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è —Ñ–∞–π–ª—ã. | `lecture-notes` |
| `aws.s3.region` | –†–µ–≥–∏–æ–Ω S3 (–¥–ª—è MinIO –æ–±—ã—á–Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–µ–Ω). | `us-east-1` |

### –ë—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π (RabbitMQ)
| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|:---|:---|:---|
| `SPRING_RABBITMQ_HOST` | –•–æ—Å—Ç RabbitMQ. | `localhost` |
| `SPRING_RABBITMQ_PORT` | –ü–æ—Ä—Ç AMQP. | `5672` |
| `SPRING_RABBITMQ_USERNAME` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å RabbitMQ. | `guest` |
| `SPRING_RABBITMQ_PASSWORD` | –ü–∞—Ä–æ–ª—å RabbitMQ. | `guest` |

### –õ–æ–≥–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫
| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|:---|:---|:---|
| `ML_SERVICE_URL` | URL –≤–Ω–µ—à–Ω–µ–≥–æ ML-—Å–µ—Ä–≤–∏—Å–∞ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è Healthcheck –∏–ª–∏ –ø—Ä—è–º–æ–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏). | *–ù–µ—Ç* |
| `app.scheduling.cleanup-cron` | CRON-–≤—ã—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –∑–∞–¥–∞—á–∏ –æ—á–∏—Å—Ç–∫–∏ –∑–∞–≤–∏—Å—à–∏—Ö –∫–æ–Ω—Å–ø–µ–∫—Ç–æ–≤. | `0 */2 * * * *` (–∫–∞–∂–¥—ã–µ 2 –º–∏–Ω) |
| `app.notes.processing-timeout-minutes` | –í—Ä–µ–º—è –≤ –º–∏–Ω—É—Ç–∞—Ö, –ø–æ—Å–ª–µ –∫–æ—Ç–æ—Ä–æ–≥–æ —Å—Ç–∞—Ç—É—Å `PROCESSING` –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ `FAILED`. | `10` |

## üìö API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ Swagger UI –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É:
**[http://localhost:8080/swagger-ui.html](http://localhost:8080/swagger-ui.html)**
